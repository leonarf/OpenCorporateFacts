{% block body %}
<div id="mynetwork"></div>
  {% block javascripts %}
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.css" rel="stylesheet" type="text/css" />
    <style type="text/css">
        #mynetwork {
            height: 800px;
            border: 1px solid lightgray;
        }
    </style>
<script type="text/javascript">

var serverData = {"result":[{"sirene": {"entreprise": {"siren": "398105585", "datedebut": "2018-11-06", "nomunitelegale": null, "sexeunitelegale": null, "sigleunitelegale": null, "prenom1unitelegale": null, "prenom2unitelegale": null, "prenom3unitelegale": null, "prenom4unitelegale": null, "categorieentreprise": "PME", "nicsiegeunitelegale": "00028", "nomusageunitelegale": null, "pseudonymeunitelegale": null, "prenomusuelunitelegale": null, "unitepurgeeunitelegale": null, "datecreationunitelegale": "1994-08-10", "denominationunitelegale": "SEM ELAN CHALON", "anneecategorieentreprise": "2017", "anneeeffectifsunitelegale": "2017", "nombreperiodesunitelegale": "8", "statutdiffusionunitelegale": "O", "trancheeffectifsunitelegale": "12", "etatadministratifunitelegale": "A", "activiteprincipaleunitelegale": "85.51Z", "caractereemployeurunitelegale": "O", "categoriejuridiqueunitelegale": "5515", "denominationusuelle1unitelegale": null, "denominationusuelle2unitelegale": null, "denominationusuelle3unitelegale": null, "datederniertraitementunitelegale": "2019-06-24T13:21:30", "identifiantassociationunitelegale": null, "economiesocialesolidaireunitelegale": "N", "nomenclatureactiviteprincipaleunitelegale": "NAFRev2"}, "etablissements": [{"nic": "00010", "geom": {"type": "Point", "coordinates": [4.847165, 46.781061]}, "siret": "39810558500010", "geo_id": "71076_5400_3d29bc", "geo_l4": "RUE DU 11 NOVEMBRE 1918", "geo_l5": null, "geo_type": "street", "latitude": "46.781061", "datedebut": "2001-12-31", "geo_ligne": "G", "geo_score": "0.93", "longitude": "4.847165", "geo_adresse": "Rue du 11 Novembre 1918 71100 Chalon-sur-Saône", "etablissementsiege": "false", "typevoieetablissement": "RUE", "codecedexetablissement": null, "enseigne1etablissement": null, "enseigne2etablissement": null, "enseigne3etablissement": null, "typevoie2etablissement": null, "codecedex2etablissement": null, "codepostaletablissement": "71100", "numerovoieetablissement": null, "codecommuneetablissement": "71076", "codepostal2etablissement": null, "libellevoieetablissement": "DU 11 NOVEMBRE 1918", "numerovoie2etablissement": null, "codecommune2etablissement": null, "datecreationetablissement": "1994-08-10", "libellecedexetablissement": null, "libellevoie2etablissement": null, "libellecedex2etablissement": null, "anneeeffectifsetablissement": null, "libellecommuneetablissement": "CHALON SUR SAONE", "nombreperiodesetablissement": "5", "libellecommune2etablissement": null, "statutdiffusionetablissement": "O", "codepaysetrangeretablissement": null, "indicerepetitionetablissement": null, "trancheeffectifsetablissement": "NN", "codepaysetranger2etablissement": null, "complementadresseetablissement": "MAISON DES SPORTS", "etatadministratifetablissement": "F", "indicerepetition2etablissement": null, "activiteprincipaleetablissement": "74.1J", "caractereemployeuretablissement": "O", "complementadresse2etablissement": null, "denominationusuelleetablissement": null, "libellepaysetrangeretablissement": null, "distributionspecialeetablissement": null, "libellepaysetranger2etablissement": null, "datederniertraitementetablissement": null, "distributionspeciale2etablissement": null, "libellecommuneetrangeretablissement": null, "libellecommuneetranger2etablissement": null, "nomenclatureactiviteprincipaleetablissement": "NAF1993", "activiteprincipaleregistremetiersetablissement": null}, {"nic": "00028", "geom": {"type": "Point", "coordinates": [4.866313, 46.785836]}, "siret": "39810558500028", "geo_id": "71076_XXXX_65cc70", "geo_l4": "RUE D AMSTERDAM", "geo_l5": null, "geo_type": "street", "latitude": "46.785836", "datedebut": "2008-01-01", "geo_ligne": "G", "geo_score": "0.93", "longitude": "4.866313", "geo_adresse": "Rue d'Amsterdam 71100 Chalon-sur-Saône", "etablissementsiege": "true", "typevoieetablissement": "RUE", "codecedexetablissement": null, "enseigne1etablissement": null, "enseigne2etablissement": null, "enseigne3etablissement": null, "typevoie2etablissement": null, "codecedex2etablissement": null, "codepostaletablissement": "71100", "numerovoieetablissement": null, "codecommuneetablissement": "71076", "codepostal2etablissement": null, "libellevoieetablissement": "D AMSTERDAM", "numerovoie2etablissement": null, "codecommune2etablissement": null, "datecreationetablissement": "2001-07-01", "libellecedexetablissement": null, "libellevoie2etablissement": null, "libellecedex2etablissement": null, "anneeeffectifsetablissement": "2017", "libellecommuneetablissement": "CHALON SUR SAONE", "nombreperiodesetablissement": "3", "libellecommune2etablissement": null, "statutdiffusionetablissement": "O", "codepaysetrangeretablissement": null, "indicerepetitionetablissement": null, "trancheeffectifsetablissement": "12", "codepaysetranger2etablissement": null, "complementadresseetablissement": "LE COLISEE", "etatadministratifetablissement": "A", "indicerepetition2etablissement": null, "activiteprincipaleetablissement": "85.51Z", "caractereemployeuretablissement": "O", "complementadresse2etablissement": null, "denominationusuelleetablissement": null, "libellepaysetrangeretablissement": null, "distributionspecialeetablissement": null, "libellepaysetranger2etablissement": null, "datederniertraitementetablissement": "2019-06-24T13:21:30", "distributionspeciale2etablissement": null, "libellecommuneetrangeretablissement": null, "libellecommuneetranger2etablissement": null, "nomenclatureactiviteprincipaleetablissement": "NAFRev2", "activiteprincipaleregistremetiersetablissement": null}]}},{"rncs": {"greffes": [{"created_at": "2019-03-06 23:14:39.419649", "nom_greffe": "Chalon-sur-Saône", "numero_rcs": null, "updated_at": "2019-03-06 23:14:39.419649", "code_greffe": "7102", "sans_activite": null, "code_radiation": null, "date_radiation": null, "date_transfert": null, "numero_gestion": "1994B00233", "motif_radiation": null, "type_inscription": "P", "date_debut_activite": null, "date_immatriculation": "1994-08-25", "date_cessation_activite": null, "date_derniere_modification": "2017-12-20", "date_debut_premiere_activite": null, "date_premiere_immatriculation": null, "libelle_derniere_modification": "Création"}], "observations": [{"etat": "Ajout", "texte": "SOCIETE ANONYME D'ECONOMIE MIXTE LOCALE A CONSEIL D'ADMINISTRATION", "numero": null, "created_at": "2019-03-06 23:14:41.681034", "date_ajout": null, "updated_at": "2019-03-06 23:14:41.681034", "code_greffe": "7102", "id_observation": "99991", "numero_gestion": "1994B00233", "date_suppression": null, "date_derniere_modification": "2017-12-20", "libelle_derniere_modification": null}, {"etat": "Ajout", "texte": "LA CONVERSION DU MONTANT DU CAPITAL DES FRANCS EN EUROS A ETE EFFECTUEE D'OFFICE PAR LE GREFFE EN APPLICATION DU DECRET No 2001-474 DU 30 MAI 2001 : ANCIEN MONTANT : 1 700 000.00 FRF NOUVEAU MONTANT : 259 163.33 EUR", "numero": null, "created_at": "2019-03-06 23:14:41.689478", "date_ajout": null, "updated_at": "2019-03-06 23:14:41.689478", "code_greffe": "7102", "id_observation": "99998", "numero_gestion": "1994B00233", "date_suppression": null, "date_derniere_modification": "2017-12-20", "libelle_derniere_modification": null}], "representants": [{"prenoms": null, "qualite": "Commissaire aux comptes titulaire", "siren_pm": "323192591", "nom_usage": null, "created_at": "2019-03-07 18:40:57.923863", "pseudonyme": null, "updated_at": "2019-03-07 18:40:57.923863", "code_greffe": "7102", "nationalite": null, "adresse_pays": "FRANCE", "denomination": "CORGECO DIAZ ET ASSOCIES CABINET D'ORGANISATION DE GESTION ET D'EXPERTIXE COMPTABLE", "adresse_ville": "Le Creusot", "nom_patronyme": null, "date_naissance": null, "numero_gestion": "1994B00233", "pays_naissance": null, "adresse_ligne_1": null, "adresse_ligne_2": "6 Rue de Nolay", "adresse_ligne_3": null, "forme_juridique": "Société anonyme", "id_representant": "46", "ville_naissance": null, "type_representant": "P. Morale", "adresse_code_postal": "71200", "adresse_code_commune": "71153", "conjoint_collab_prenoms": null, "conjoint_collab_date_fin": null, "conjoint_collab_nom_usage": null, "conjoint_collab_pseudonyme": null, "date_derniere_modification": "2019-02-20", "conjoint_collab_nom_patronyme": null, "libelle_derniere_modification": "Nouveau dirigeant", "representant_permanent_prenoms": null, "representant_permanent_nom_usage": null, "representant_permanent_pseudonyme": null, "representant_permanent_nationalite": null, "representant_permanent_adresse_pays": null, "representant_permanent_adresse_ville": null, "representant_permanent_nom_patronyme": null, "representant_permanent_date_naissance": null, "representant_permanent_pays_naissance": null, "representant_permanent_adresse_ligne_1": null, "representant_permanent_adresse_ligne_2": null, "representant_permanent_adresse_ligne_3": null, "representant_permanent_ville_naissance": null, "representant_permanent_adresse_code_postal": null, "representant_permanent_adresse_code_commune": null}, {"prenoms": null, "qualite": "Administrateur", "siren_pm": null, "nom_usage": null, "created_at": "2019-03-06 23:14:41.09324", "pseudonyme": null, "updated_at": "2019-03-07 18:40:57.929254", "code_greffe": "7102", "nationalite": null, "adresse_pays": "FRANCE", "denomination": "ASSOCIATION ELAN CHALON", "adresse_ville": "Chalon-sur-Saône", "nom_patronyme": null, "date_naissance": null, "numero_gestion": "1994B00233", "pays_naissance": null, "adresse_ligne_1": null, "adresse_ligne_2": "rue d'Amsterdam", "adresse_ligne_3": "le Colisée", "forme_juridique": "Autre forme juridique", "id_representant": "23", "ville_naissance": null, "type_representant": "P. Morale", "adresse_code_postal": "71100", "adresse_code_commune": "71076", "conjoint_collab_prenoms": null, "conjoint_collab_date_fin": null, "conjoint_collab_nom_usage": null, "conjoint_collab_pseudonyme": null, "date_derniere_modification": "2019-02-20", "conjoint_collab_nom_patronyme": null, "libelle_derniere_modification": "Modifications relatives au(x) dirigeants", "representant_permanent_prenoms": "Christine Denise Marie", "representant_permanent_nom_usage": "JUILLOT", "representant_permanent_pseudonyme": null, "representant_permanent_nationalite": "Française", "representant_permanent_adresse_pays": "FRANCE", "representant_permanent_adresse_ville": "Mercurey", "representant_permanent_nom_patronyme": "PARISOT", "representant_permanent_date_naissance": "1957-02-18", "representant_permanent_pays_naissance": "FRANCE", "representant_permanent_adresse_ligne_1": null, "representant_permanent_adresse_ligne_2": "9 rue de Mercurey", "representant_permanent_adresse_ligne_3": null, "representant_permanent_ville_naissance": "92051 \"NEUILLY SUR SEINE", "representant_permanent_adresse_code_postal": "71640", "representant_permanent_adresse_code_commune": "71294"}, {"prenoms": null, "qualite": "Administrateur", "siren_pm": null, "nom_usage": null, "created_at": "2019-03-06 23:14:41.084794", "pseudonyme": null, "updated_at": "2019-03-07 18:40:57.934342", "code_greffe": "7102", "nationalite": null, "adresse_pays": "FRANCE", "denomination": "ASSOCATION ELAN PASSION", "adresse_ville": "CHALON SUR SAONE", "nom_patronyme": null, "date_naissance": null, "numero_gestion": "1994B00233", "pays_naissance": null, "adresse_ligne_1": null, "adresse_ligne_2": "MAISON DES SPORTS - 3 RUE DU 11 NOVEMBRE 1918", "adresse_ligne_3": "CHALON SUR SAONE", "forme_juridique": "Association", "id_representant": "19", "ville_naissance": null, "type_representant": "P. Morale", "adresse_code_postal": "71100", "adresse_code_commune": null, "conjoint_collab_prenoms": null, "conjoint_collab_date_fin": null, "conjoint_collab_nom_usage": null, "conjoint_collab_pseudonyme": null, "date_derniere_modification": "2019-02-20", "conjoint_collab_nom_patronyme": null, "libelle_derniere_modification": "Modifications relatives au(x) dirigeants", "representant_permanent_prenoms": "Philippe Felix", "representant_permanent_nom_usage": null, "representant_permanent_pseudonyme": null, "representant_permanent_nationalite": "Française", "representant_permanent_adresse_pays": "FRANCE", "representant_permanent_adresse_ville": "Chalon-sur-Saône", "representant_permanent_nom_patronyme": "BARNAY", "representant_permanent_date_naissance": "1964-11-11", "representant_permanent_pays_naissance": "FRANCE", "representant_permanent_adresse_ligne_1": null, "representant_permanent_adresse_ligne_2": "11 rue LESCHENAULT DE LA TOUR", "representant_permanent_adresse_ligne_3": null, "representant_permanent_ville_naissance": "71076 \"CHALON SUR SAONE", "representant_permanent_adresse_code_postal": "71100", "representant_permanent_adresse_code_commune": "71076"}, {"prenoms": null, "qualite": "Administrateur", "siren_pm": "000000000", "nom_usage": null, "created_at": "2019-03-06 23:14:41.104152", "pseudonyme": null, "updated_at": "2019-03-07 18:40:57.939533", "code_greffe": "7102", "nationalite": null, "adresse_pays": "FRANCE", "denomination": "VILLE DE CHALON SUR SAONE", "adresse_ville": "Chalon-sur-Saône", "nom_patronyme": null, "date_naissance": null, "numero_gestion": "1994B00233", "pays_naissance": null, "adresse_ligne_1": null, "adresse_ligne_2": "place DE L'HOTEL DE VILLE", "adresse_ligne_3": null, "forme_juridique": "Autre forme juridique", "id_representant": "38", "ville_naissance": null, "type_representant": "P. Morale", "adresse_code_postal": "71100", "adresse_code_commune": "71076", "conjoint_collab_prenoms": null, "conjoint_collab_date_fin": null, "conjoint_collab_nom_usage": null, "conjoint_collab_pseudonyme": null, "date_derniere_modification": "2019-02-20", "conjoint_collab_nom_patronyme": null, "libelle_derniere_modification": "Modifications relatives au(x) dirigeants", "representant_permanent_prenoms": "Dominique Marie", "representant_permanent_nom_usage": "MELIN", "representant_permanent_pseudonyme": null, "representant_permanent_nationalite": "Française", "representant_permanent_adresse_pays": "FRANCE", "representant_permanent_adresse_ville": "Chalon-sur-Saône", "representant_permanent_nom_patronyme": "LAUSSEUR", "representant_permanent_date_naissance": "1958-01-28", "representant_permanent_pays_naissance": "FRANCE", "representant_permanent_adresse_ligne_1": null, "representant_permanent_adresse_ligne_2": "12 allée de Magnolias", "representant_permanent_adresse_ligne_3": null, "representant_permanent_ville_naissance": "79270 \"ST MAIXENT L ECOLE", "representant_permanent_adresse_code_postal": "71100", "representant_permanent_adresse_code_commune": "71076"}, {"prenoms": "Dominique René", "qualite": "Président du conseil d'administration", "siren_pm": null, "nom_usage": null, "created_at": "2019-03-06 23:14:41.027596", "pseudonyme": null, "updated_at": "2019-03-06 23:14:41.027596", "code_greffe": "7102", "nationalite": "Française", "adresse_pays": "FRANCE", "denomination": null, "adresse_ville": "Mercurey", "nom_patronyme": "JUILLOT", "date_naissance": "1954-05-09", "numero_gestion": "1994B00233", "pays_naissance": "FRANCE", "adresse_ligne_1": null, "adresse_ligne_2": "9 rue DE MERCUREY", "adresse_ligne_3": null, "forme_juridique": null, "id_representant": "1", "ville_naissance": "01385 \"ST REMY", "type_representant": "P.Physique", "adresse_code_postal": "71640", "adresse_code_commune": "71294", "conjoint_collab_prenoms": null, "conjoint_collab_date_fin": null, "conjoint_collab_nom_usage": null, "conjoint_collab_pseudonyme": null, "date_derniere_modification": "2017-12-20", "conjoint_collab_nom_patronyme": null, "libelle_derniere_modification": "Nouveau dirigeant", "representant_permanent_prenoms": null, "representant_permanent_nom_usage": null, "representant_permanent_pseudonyme": null, "representant_permanent_nationalite": null, "representant_permanent_adresse_pays": null, "representant_permanent_adresse_ville": null, "representant_permanent_nom_patronyme": null, "representant_permanent_date_naissance": null, "representant_permanent_pays_naissance": null, "representant_permanent_adresse_ligne_1": null, "representant_permanent_adresse_ligne_2": null, "representant_permanent_adresse_ligne_3": null, "representant_permanent_ville_naissance": null, "representant_permanent_adresse_code_postal": null, "representant_permanent_adresse_code_commune": null}, {"prenoms": "Dominique René", "qualite": "Administrateur", "siren_pm": null, "nom_usage": null, "created_at": "2019-03-06 23:14:41.03642", "pseudonyme": null, "updated_at": "2019-03-06 23:14:41.03642", "code_greffe": "7102", "nationalite": "Française", "adresse_pays": "FRANCE", "denomination": null, "adresse_ville": "Mercurey", "nom_patronyme": "JUILLOT", "date_naissance": "1954-05-09", "numero_gestion": "1994B00233", "pays_naissance": "FRANCE", "adresse_ligne_1": null, "adresse_ligne_2": "9 rue DE MERCUREY", "adresse_ligne_3": null, "forme_juridique": null, "id_representant": "1", "ville_naissance": "01385 \"ST REMY", "type_representant": "P.Physique", "adresse_code_postal": "71640", "adresse_code_commune": "71294", "conjoint_collab_prenoms": null, "conjoint_collab_date_fin": null, "conjoint_collab_nom_usage": null, "conjoint_collab_pseudonyme": null, "date_derniere_modification": "2017-12-20", "conjoint_collab_nom_patronyme": null, "libelle_derniere_modification": "Nouveau dirigeant", "representant_permanent_prenoms": null, "representant_permanent_nom_usage": null, "representant_permanent_pseudonyme": null, "representant_permanent_nationalite": null, "representant_permanent_adresse_pays": null, "representant_permanent_adresse_ville": null, "representant_permanent_nom_patronyme": null, "representant_permanent_date_naissance": null, "representant_permanent_pays_naissance": null, "representant_permanent_adresse_ligne_1": null, "representant_permanent_adresse_ligne_2": null, "representant_permanent_adresse_ligne_3": null, "representant_permanent_ville_naissance": null, "representant_permanent_adresse_code_postal": null, "representant_permanent_adresse_code_commune": null}, {"prenoms": "Rémy", "qualite": "Directeur général", "siren_pm": null, "nom_usage": null, "created_at": "2019-03-06 23:14:41.044245", "pseudonyme": null, "updated_at": "2019-03-06 23:14:41.044245", "code_greffe": "7102", "nationalite": "Française", "adresse_pays": "FRANCE", "denomination": null, "adresse_ville": "Chalon-sur-Saône", "nom_patronyme": "DELPON", "date_naissance": "1967-05-31", "numero_gestion": "1994B00233", "pays_naissance": "FRANCE", "adresse_ligne_1": null, "adresse_ligne_2": "31 rue Emile Zola", "adresse_ligne_3": null, "forme_juridique": null, "id_representant": "40", "ville_naissance": "75115 \"Paris 15", "type_representant": "P.Physique", "adresse_code_postal": "71100", "adresse_code_commune": "71076", "conjoint_collab_prenoms": null, "conjoint_collab_date_fin": null, "conjoint_collab_nom_usage": null, "conjoint_collab_pseudonyme": null, "date_derniere_modification": "2017-12-20", "conjoint_collab_nom_patronyme": null, "libelle_derniere_modification": "Nouveau dirigeant", "representant_permanent_prenoms": null, "representant_permanent_nom_usage": null, "representant_permanent_pseudonyme": null, "representant_permanent_nationalite": null, "representant_permanent_adresse_pays": null, "representant_permanent_adresse_ville": null, "representant_permanent_nom_patronyme": null, "representant_permanent_date_naissance": null, "representant_permanent_pays_naissance": null, "representant_permanent_adresse_ligne_1": null, "representant_permanent_adresse_ligne_2": null, "representant_permanent_adresse_ligne_3": null, "representant_permanent_ville_naissance": null, "representant_permanent_adresse_code_postal": null, "representant_permanent_adresse_code_commune": null}, {"prenoms": "Rémy", "qualite": "Administrateur", "siren_pm": null, "nom_usage": null, "created_at": "2019-03-06 23:14:41.052531", "pseudonyme": null, "updated_at": "2019-03-06 23:14:41.052531", "code_greffe": "7102", "nationalite": "Française", "adresse_pays": "FRANCE", "denomination": null, "adresse_ville": "Chalon-sur-Saône", "nom_patronyme": "DELPON", "date_naissance": "1967-05-31", "numero_gestion": "1994B00233", "pays_naissance": "FRANCE", "adresse_ligne_1": null, "adresse_ligne_2": "31 rue Emile Zola", "adresse_ligne_3": null, "forme_juridique": null, "id_representant": "40", "ville_naissance": "75115 \"Paris 15", "type_representant": "P.Physique", "adresse_code_postal": "71100", "adresse_code_commune": "71076", "conjoint_collab_prenoms": null, "conjoint_collab_date_fin": null, "conjoint_collab_nom_usage": null, "conjoint_collab_pseudonyme": null, "date_derniere_modification": "2017-12-20", "conjoint_collab_nom_patronyme": null, "libelle_derniere_modification": "Nouveau dirigeant", "representant_permanent_prenoms": null, "representant_permanent_nom_usage": null, "representant_permanent_pseudonyme": null, "representant_permanent_nationalite": null, "representant_permanent_adresse_pays": null, "representant_permanent_adresse_ville": null, "representant_permanent_nom_patronyme": null, "representant_permanent_date_naissance": null, "representant_permanent_pays_naissance": null, "representant_permanent_adresse_ligne_1": null, "representant_permanent_adresse_ligne_2": null, "representant_permanent_adresse_ligne_3": null, "representant_permanent_ville_naissance": null, "representant_permanent_adresse_code_postal": null, "representant_permanent_adresse_code_commune": null}, {"prenoms": "Hubert Constant Joseph Florent", "qualite": "Administrateur", "siren_pm": null, "nom_usage": null, "created_at": "2019-03-06 23:14:41.061085", "pseudonyme": null, "updated_at": "2019-03-06 23:14:41.061085", "code_greffe": "7102", "nationalite": "Française", "adresse_pays": "FRANCE", "denomination": null, "adresse_ville": "CHATENOY LE ROYAL", "nom_patronyme": "MAUDET", "date_naissance": "1950-11-15", "numero_gestion": "1994B00233", "pays_naissance": null, "adresse_ligne_1": null, "adresse_ligne_2": "9 RUE DU BERRY", "adresse_ligne_3": "CHATENOY LE ROYAL", "forme_juridique": null, "id_representant": "2", "ville_naissance": "BEAULIEU SUR OUDON 53", "type_representant": "P.Physique", "adresse_code_postal": "71880", "adresse_code_commune": null, "conjoint_collab_prenoms": null, "conjoint_collab_date_fin": null, "conjoint_collab_nom_usage": null, "conjoint_collab_pseudonyme": null, "date_derniere_modification": "2017-12-20", "conjoint_collab_nom_patronyme": null, "libelle_derniere_modification": "Nouveau dirigeant", "representant_permanent_prenoms": null, "representant_permanent_nom_usage": null, "representant_permanent_pseudonyme": null, "representant_permanent_nationalite": null, "representant_permanent_adresse_pays": null, "representant_permanent_adresse_ville": null, "representant_permanent_nom_patronyme": null, "representant_permanent_date_naissance": null, "representant_permanent_pays_naissance": null, "representant_permanent_adresse_ligne_1": null, "representant_permanent_adresse_ligne_2": null, "representant_permanent_adresse_ligne_3": null, "representant_permanent_ville_naissance": null, "representant_permanent_adresse_code_postal": null, "representant_permanent_adresse_code_commune": null}, {"prenoms": "Gerard Alexandre Etienne", "qualite": "Administrateur", "siren_pm": null, "nom_usage": null, "created_at": "2019-03-06 23:14:41.076215", "pseudonyme": null, "updated_at": "2019-03-06 23:14:41.076215", "code_greffe": "7102", "nationalite": "Française", "adresse_pays": "FRANCE", "denomination": null, "adresse_ville": "Dracy-le-Fort", "nom_patronyme": "BAROCHE", "date_naissance": "1958-06-05", "numero_gestion": "1994B00233", "pays_naissance": "FRANCE", "adresse_ligne_1": null, "adresse_ligne_2": "6 rue DU PREMOY", "adresse_ligne_3": null, "forme_juridique": null, "id_representant": "10", "ville_naissance": "71076 \"CHALON SUR SAONE", "type_representant": "P.Physique", "adresse_code_postal": "71640", "adresse_code_commune": "71182", "conjoint_collab_prenoms": null, "conjoint_collab_date_fin": null, "conjoint_collab_nom_usage": null, "conjoint_collab_pseudonyme": null, "date_derniere_modification": "2017-12-20", "conjoint_collab_nom_patronyme": null, "libelle_derniere_modification": "Nouveau dirigeant", "representant_permanent_prenoms": null, "representant_permanent_nom_usage": null, "representant_permanent_pseudonyme": null, "representant_permanent_nationalite": null, "representant_permanent_adresse_pays": null, "representant_permanent_adresse_ville": null, "representant_permanent_nom_patronyme": null, "representant_permanent_date_naissance": null, "representant_permanent_pays_naissance": null, "representant_permanent_adresse_ligne_1": null, "representant_permanent_adresse_ligne_2": null, "representant_permanent_adresse_ligne_3": null, "representant_permanent_ville_naissance": null, "representant_permanent_adresse_code_postal": null, "representant_permanent_adresse_code_commune": null}, {"prenoms": null, "qualite": "Administrateur", "siren_pm": null, "nom_usage": null, "created_at": "2019-03-06 23:14:41.110549", "pseudonyme": null, "updated_at": "2019-03-06 23:14:41.110549", "code_greffe": "7102", "nationalite": null, "adresse_pays": "FRANCE", "denomination": "VILLE DE CHALON SUR SAONE", "adresse_ville": "Chalon-sur-Saône", "nom_patronyme": null, "date_naissance": null, "numero_gestion": "1994B00233", "pays_naissance": null, "adresse_ligne_1": null, "adresse_ligne_2": "place de l'Hôtel de Ville", "adresse_ligne_3": null, "forme_juridique": "Collectivité territoriale de la République", "id_representant": "42", "ville_naissance": null, "type_representant": "P. Morale", "adresse_code_postal": "71100", "adresse_code_commune": "71076", "conjoint_collab_prenoms": null, "conjoint_collab_date_fin": null, "conjoint_collab_nom_usage": null, "conjoint_collab_pseudonyme": null, "date_derniere_modification": "2017-12-20", "conjoint_collab_nom_patronyme": null, "libelle_derniere_modification": "Nouveau dirigeant", "representant_permanent_prenoms": "Philippe", "representant_permanent_nom_usage": null, "representant_permanent_pseudonyme": null, "representant_permanent_nationalite": "Française", "representant_permanent_adresse_pays": "FRANCE", "representant_permanent_adresse_ville": "Chalon-sur-Saône", "representant_permanent_nom_patronyme": "FINAS", "representant_permanent_date_naissance": "1959-03-14", "representant_permanent_pays_naissance": "FRANCE", "representant_permanent_adresse_ligne_1": null, "representant_permanent_adresse_ligne_2": "14B QUAI SAINTE MARIE", "representant_permanent_adresse_ligne_3": null, "representant_permanent_ville_naissance": "54395 \"NANCY", "representant_permanent_adresse_code_postal": "71100", "representant_permanent_adresse_code_commune": "71076"}, {"prenoms": null, "qualite": "Administrateur", "siren_pm": null, "nom_usage": null, "created_at": "2019-03-06 23:14:41.118733", "pseudonyme": null, "updated_at": "2019-03-06 23:14:41.118733", "code_greffe": "7102", "nationalite": null, "adresse_pays": "FRANCE", "denomination": "VILLE DE CHALON SUR SAONE", "adresse_ville": "Chalon-sur-Saône", "nom_patronyme": null, "date_naissance": null, "numero_gestion": "1994B00233", "pays_naissance": null, "adresse_ligne_1": null, "adresse_ligne_2": "place de l'Hôtel de Ville", "adresse_ligne_3": null, "forme_juridique": "Collectivité territoriale de la République", "id_representant": "42", "ville_naissance": null, "type_representant": "P. Morale", "adresse_code_postal": "71100", "adresse_code_commune": "71076", "conjoint_collab_prenoms": null, "conjoint_collab_date_fin": null, "conjoint_collab_nom_usage": null, "conjoint_collab_pseudonyme": null, "date_derniere_modification": "2017-12-20", "conjoint_collab_nom_patronyme": null, "libelle_derniere_modification": "Nouveau dirigeant", "representant_permanent_prenoms": "Philippe", "representant_permanent_nom_usage": null, "representant_permanent_pseudonyme": null, "representant_permanent_nationalite": "Française", "representant_permanent_adresse_pays": "FRANCE", "representant_permanent_adresse_ville": "Chalon-sur-Saône", "representant_permanent_nom_patronyme": "FINAS", "representant_permanent_date_naissance": "1959-03-14", "representant_permanent_pays_naissance": "FRANCE", "representant_permanent_adresse_ligne_1": null, "representant_permanent_adresse_ligne_2": "14B QUAI SAINTE MARIE", "representant_permanent_adresse_ligne_3": null, "representant_permanent_ville_naissance": "54395 \"NANCY", "representant_permanent_adresse_code_postal": "71100", "representant_permanent_adresse_code_commune": "71076"}, {"prenoms": null, "qualite": "Administrateur", "siren_pm": null, "nom_usage": null, "created_at": "2019-03-06 23:14:41.126183", "pseudonyme": null, "updated_at": "2019-03-06 23:14:41.126183", "code_greffe": "7102", "nationalite": null, "adresse_pays": "FRANCE", "denomination": "VILLE DE CHALON SUR SAONE", "adresse_ville": "Chalon-sur-Saône", "nom_patronyme": null, "date_naissance": null, "numero_gestion": "1994B00233", "pays_naissance": null, "adresse_ligne_1": null, "adresse_ligne_2": "place de l'Hôtel de Ville", "adresse_ligne_3": null, "forme_juridique": "Collectivité territoriale de la République", "id_representant": "43", "ville_naissance": null, "type_representant": "P. Morale", "adresse_code_postal": "71100", "adresse_code_commune": "71076", "conjoint_collab_prenoms": null, "conjoint_collab_date_fin": null, "conjoint_collab_nom_usage": null, "conjoint_collab_pseudonyme": null, "date_derniere_modification": "2017-12-20", "conjoint_collab_nom_patronyme": null, "libelle_derniere_modification": "Nouveau dirigeant", "representant_permanent_prenoms": "Francine Claude", "representant_permanent_nom_usage": "CHOPARD", "representant_permanent_pseudonyme": null, "representant_permanent_nationalite": "Française", "representant_permanent_adresse_pays": "FRANCE", "representant_permanent_adresse_ville": "Chalon-sur-Saône", "representant_permanent_nom_patronyme": "COURVOISIER", "representant_permanent_date_naissance": "1957-04-04", "representant_permanent_pays_naissance": "FRANCE", "representant_permanent_adresse_ligne_1": null, "representant_permanent_adresse_ligne_2": "34 QUAI GAMBETTA", "representant_permanent_adresse_ligne_3": null, "representant_permanent_ville_naissance": "21231 \"DIJON", "representant_permanent_adresse_code_postal": "71100", "representant_permanent_adresse_code_commune": "71076"}, {"prenoms": null, "qualite": "Administrateur", "siren_pm": null, "nom_usage": null, "created_at": "2019-03-06 23:14:41.134929", "pseudonyme": null, "updated_at": "2019-03-06 23:14:41.134929", "code_greffe": "7102", "nationalite": null, "adresse_pays": "FRANCE", "denomination": "VILLE DE CHALON SUR SAONE", "adresse_ville": "Chalon-sur-Saône", "nom_patronyme": null, "date_naissance": null, "numero_gestion": "1994B00233", "pays_naissance": null, "adresse_ligne_1": null, "adresse_ligne_2": "place de l'Hôtel de Ville", "adresse_ligne_3": null, "forme_juridique": "Collectivité territoriale de la République", "id_representant": "43", "ville_naissance": null, "type_representant": "P. Morale", "adresse_code_postal": "71100", "adresse_code_commune": "71076", "conjoint_collab_prenoms": null, "conjoint_collab_date_fin": null, "conjoint_collab_nom_usage": null, "conjoint_collab_pseudonyme": null, "date_derniere_modification": "2017-12-20", "conjoint_collab_nom_patronyme": null, "libelle_derniere_modification": "Nouveau dirigeant", "representant_permanent_prenoms": "Francine Claude", "representant_permanent_nom_usage": "CHOPARD", "representant_permanent_pseudonyme": null, "representant_permanent_nationalite": "Française", "representant_permanent_adresse_pays": "FRANCE", "representant_permanent_adresse_ville": "Chalon-sur-Saône", "representant_permanent_nom_patronyme": "COURVOISIER", "representant_permanent_date_naissance": "1957-04-04", "representant_permanent_pays_naissance": "FRANCE", "representant_permanent_adresse_ligne_1": null, "representant_permanent_adresse_ligne_2": "34 QUAI GAMBETTA", "representant_permanent_adresse_ligne_3": null, "representant_permanent_ville_naissance": "21231 \"DIJON", "representant_permanent_adresse_code_postal": "71100", "representant_permanent_adresse_code_commune": "71076"}, {"prenoms": null, "qualite": "Administrateur", "siren_pm": null, "nom_usage": null, "created_at": "2019-03-06 23:14:41.143427", "pseudonyme": null, "updated_at": "2019-03-06 23:14:41.143427", "code_greffe": "7102", "nationalite": null, "adresse_pays": "FRANCE", "denomination": "VILLE DE CHALON SUR SAONE", "adresse_ville": "Chalon-sur-Saône", "nom_patronyme": null, "date_naissance": null, "numero_gestion": "1994B00233", "pays_naissance": null, "adresse_ligne_1": null, "adresse_ligne_2": "place de l'Hôtel de Ville", "adresse_ligne_3": null, "forme_juridique": "Collectivité territoriale de la République", "id_representant": "44", "ville_naissance": null, "type_representant": "P. Morale", "adresse_code_postal": "71100", "adresse_code_commune": "71076", "conjoint_collab_prenoms": null, "conjoint_collab_date_fin": null, "conjoint_collab_nom_usage": null, "conjoint_collab_pseudonyme": null, "date_derniere_modification": "2017-12-20", "conjoint_collab_nom_patronyme": null, "libelle_derniere_modification": "Nouveau dirigeant", "representant_permanent_prenoms": "Hervé", "representant_permanent_nom_usage": null, "representant_permanent_pseudonyme": null, "representant_permanent_nationalite": "Française", "representant_permanent_adresse_pays": "FRANCE", "representant_permanent_adresse_ville": "Chalon-sur-Saône", "representant_permanent_nom_patronyme": "DUMAINE", "representant_permanent_date_naissance": "1958-09-14", "representant_permanent_pays_naissance": "FRANCE", "representant_permanent_adresse_ligne_1": null, "representant_permanent_adresse_ligne_2": "33 rue Garibaldi", "representant_permanent_adresse_ligne_3": null, "representant_permanent_ville_naissance": "71475 \"ST REMY", "representant_permanent_adresse_code_postal": "71100", "representant_permanent_adresse_code_commune": "71076"}, {"prenoms": null, "qualite": "Administrateur", "siren_pm": null, "nom_usage": null, "created_at": "2019-03-06 23:14:41.152487", "pseudonyme": null, "updated_at": "2019-03-06 23:14:41.152487", "code_greffe": "7102", "nationalite": null, "adresse_pays": "FRANCE", "denomination": "CONSEIL DEPARTEMENTAL", "adresse_ville": "Macon", "nom_patronyme": null, "date_naissance": null, "numero_gestion": "1994B00233", "pays_naissance": null, "adresse_ligne_1": null, "adresse_ligne_2": "rue de Lingendes", "adresse_ligne_3": null, "forme_juridique": "Collectivité territoriale de la République", "id_representant": "41", "ville_naissance": null, "type_representant": "P. Morale", "adresse_code_postal": "71000", "adresse_code_commune": "71270", "conjoint_collab_prenoms": null, "conjoint_collab_date_fin": null, "conjoint_collab_nom_usage": null, "conjoint_collab_pseudonyme": null, "date_derniere_modification": "2017-12-20", "conjoint_collab_nom_patronyme": null, "libelle_derniere_modification": "Nouveau dirigeant", "representant_permanent_prenoms": "Pierre", "representant_permanent_nom_usage": null, "representant_permanent_pseudonyme": null, "representant_permanent_nationalite": "Française", "representant_permanent_adresse_pays": "FRANCE", "representant_permanent_adresse_ville": "Charolles", "representant_permanent_nom_patronyme": "BERTHIER", "representant_permanent_date_naissance": "1956-01-13", "representant_permanent_pays_naissance": "FRANCE", "representant_permanent_adresse_ligne_1": null, "representant_permanent_adresse_ligne_2": "25 avenue du 8 juin 1944", "representant_permanent_adresse_ligne_3": null, "representant_permanent_ville_naissance": "42052 \"CHARLIEU", "representant_permanent_adresse_code_postal": "71120", "representant_permanent_adresse_code_commune": "71106"}, {"prenoms": null, "qualite": "Administrateur", "siren_pm": null, "nom_usage": null, "created_at": "2019-03-06 23:14:41.159361", "pseudonyme": null, "updated_at": "2019-03-06 23:14:41.159361", "code_greffe": "7102", "nationalite": null, "adresse_pays": "FRANCE", "denomination": "CONSEIL DEPARTEMENTAL", "adresse_ville": "Macon", "nom_patronyme": null, "date_naissance": null, "numero_gestion": "1994B00233", "pays_naissance": null, "adresse_ligne_1": null, "adresse_ligne_2": "rue de Lingendes", "adresse_ligne_3": null, "forme_juridique": "Société d'économie mixte", "id_representant": "29", "ville_naissance": null, "type_representant": "P. Morale", "adresse_code_postal": "71026", "adresse_code_commune": "71270", "conjoint_collab_prenoms": null, "conjoint_collab_date_fin": null, "conjoint_collab_nom_usage": null, "conjoint_collab_pseudonyme": null, "date_derniere_modification": "2017-12-20", "conjoint_collab_nom_patronyme": null, "libelle_derniere_modification": "Nouveau dirigeant", "representant_permanent_prenoms": "Vincent", "representant_permanent_nom_usage": null, "representant_permanent_pseudonyme": null, "representant_permanent_nationalite": "Française", "representant_permanent_adresse_pays": "FRANCE", "representant_permanent_adresse_ville": "Châtenoy-le-Royal", "representant_permanent_nom_patronyme": "BERGERET", "representant_permanent_date_naissance": "1964-06-02", "representant_permanent_pays_naissance": "FRANCE", "representant_permanent_adresse_ligne_1": null, "representant_permanent_adresse_ligne_2": "13 BIS chemin de la Brosse", "representant_permanent_adresse_ligne_3": null, "representant_permanent_ville_naissance": "71475 \"ST REMY", "representant_permanent_adresse_code_postal": "71880", "representant_permanent_adresse_code_commune": "71118"}], "etablissements": [{"activite": "Gestion et animation d'activités sportives, notamment en matière de basket Ball, donnant lieu à organisation de manifestations payantes et à versement de rémunérations.", "enseigne": null, "siege_pm": null, "created_at": "2019-03-06 23:14:41.613575", "updated_at": "2019-03-06 23:14:41.613575", "code_greffe": "7102", "adresse_pays": "FRANCE", "rcs_registre": null, "adresse_ville": "Chalon-sur-Saône", "origine_fonds": "Création", "nom_commercial": null, "numero_gestion": "1994B00233", "adresse_ligne_1": null, "adresse_ligne_2": "rue d'Amsterdam", "adresse_ligne_3": "le Colisée", "id_etablissement": "1", "type_exploitation": "Exploitation directe", "activite_ambulante": "non", "domiciliataire_nom": null, "origine_fonds_info": null, "type_etablissement": "SEP", "adresse_code_postal": "71100", "date_debut_activite": "1994-08-10", "activite_saisonniere": "non", "adresse_code_commune": "71076", "domiciliataire_siren": null, "domiciliataire_greffe": null, "activite_non_sedentaire": "non", "domiciliataire_complement": null, "date_derniere_modification": "2017-12-20", "siege_domicile_representant": null, "libelle_derniere_modification": "Etablissement ouvert"}], "personnes_morales": [{"sigle": null, "devise": "Euros", "capital": "291551.4", "duree_pm": "99", "created_at": "2019-03-06 23:14:40.791489", "updated_at": "2019-03-06 23:14:40.791489", "code_greffe": "7102", "date_cloture": "30 Juin", "denomination": "SEM ELAN CHALON", "type_capital": "F", "associe_unique": null, "capital_actuel": null, "numero_gestion": "1994B00233", "forme_juridique": "Société d'économie mixte locale à forme anonyme", "activite_principale": null, "date_derniere_modification": "2017-12-20", "economie_sociale_solidaire": "Non", "date_cloture_exceptionnelle": null, "libelle_derniere_modification": "Création"}], "personnes_physiques": null}}]};
    var nodesData = [ {id: {{ corporate.CompanyNumber }}, label: '{{ corporate.Name }}', fixed : true }];
    var links = [];
    var representantsStreamlined = {"P.Physique" : new Map(), "P. Morale" : new Map()};
    var representantsMap = new Map();
    var denominationMap = new Map();
    var colors = ["#4d4040",
                  "#c36c40",
                  "#95c15a",
                  "#90b6b7",
                  "#7c50ba",
                  "#c35d90"];
    $.get("http://api.cquest.org/company/{{ corporate.CompanyNumber }}",
    function(serverData, status){
        console.log("Response from all of fame:");
        var rncsData;
        if('rncs' in serverData.result[0]){
          rncsData = serverData.result[0].rncs;
        }
        else{
          rncsData = serverData.result[1].rncs;
        }
        console.log(rncsData.representants);
        for (const representant of rncsData.representants) {
          var nodeId = representant.id_representant;
          var nodeColor = colors[4];
          // Personne physique
          if(["P.Physique", "P. Physique"].includes(representant.type_representant))
          {
            if(representantsStreamlined["P.Physique"].has(representant.id_representant))
            {
              representantsStreamlined["P.Physique"].get(representant.id_representant).push(representant);
            }
            else{
              representantsStreamlined["P.Physique"].set(representant.id_representant, [representant]);
            }
            nodeColor = colors[1];
            nodeLabel = representant.nom_patronyme + " " + representant.prenoms;
          }
          // Personne morale
          else if(representant.type_representant == "P. Morale")
          {
            if(representantsStreamlined["P. Morale"].has(representant.denomination))
            {
              representantsStreamlined["P. Morale"].get(representant.denomination).push(representant);
            }
            else{
              representantsStreamlined["P. Morale"].set(representant.denomination, [representant]);
            }
            nodeLabel = representant.denomination;
          }
          else {
            console.log("undefined :", representant);
          }
          for (var property in representant){
            if (representant[property]===null || ["created_at", "updated_at", "code_greffe"].includes(property) ) delete representant[property];
          }
        }

        for (var physique of representantsStreamlined["P.Physique"])
        {
          var representantPhysique = physique[1][0];
          var nodeId = representantPhysique.id_representant;
          var nodeLabel = representantPhysique.nom_patronyme + " " + representantPhysique.prenoms;
          var nodeColor = colors[5];
          // Create one node per physical person
          nodesData.push({id: nodeId, label: nodeLabel, title : JSON.stringify(representantPhysique, null, '\u2028'), color : nodeColor});
          for (var rep of physique[1])
          {
            // Create one link per "qualité"
            links.push({from: {{ corporate.CompanyNumber }}, to: nodeId, label: rep.qualite });
          }
        }

        for (var morale of representantsStreamlined["P. Morale"])
        {
          var nodeId = morale[0];
          var nodeColor = colors[2];
          var nodeLabel = morale[0] + "\n représenté par ";
          if(morale[1][0].siren_pm != null)
          {
             nodeColor = colors[2];
             nodeId = morale[1][0].siren_pm;
          }
          var qualiteMap = new Map();
          for (var rep of morale[1])
          {
            if (qualiteMap.has(rep.qualite))
            {
              qualiteMap.set(rep.qualite, qualiteMap.get(rep.qualite) + 1);
            }
            else{
              qualiteMap.set(rep.qualite, 1);
            }
          }
          for (var qualite of qualiteMap)
          {
            nodeLabel += qualite[1] + " " + qualite[0] + ";";
          }

          nodesData.push({id: nodeId, label: nodeLabel, title : JSON.stringify(morale[1], null, '\u2028'), color : nodeColor});
          links.push({from: {{ corporate.CompanyNumber }}, to: nodeId, label: "" });
        }
        console.log("représentant bien rangé :", representantsStreamlined);
        console.log("node data :", nodesData);

        // create an array with nodes
        var nodes = new vis.DataSet(nodesData);

        // create an array with edges
        var edges = new vis.DataSet(links);

        // create a network
        var container = document.getElementById('mynetwork');
        var data = {
          nodes: nodes,
          edges: edges
        };

        var options = {};
        var network = new vis.Network(container, data, options);

        network.on("doubleClick", function (params) {
            params.event = "[original event]";
            var baseURL = "{{ url('corporate_show', {'siren': corporate.CompanyNumber}) }}";
            var newURL = baseURL.replace(new RegExp("/{{ corporate.CompanyNumber }}$"), "/" + params.nodes[0]);
            window.location.replace(newURL);
        });
      },
      "json");

  {% for corporationsLink in corporate.CorporateShareholders %}
    nodesData.push({id: {{ corporationsLink.OwningCorporate.Id }}, label: '{{ corporationsLink.OwningCorporate.Name }}' });
    links.push({from: {{ corporationsLink.OwningCorporate.Id }}, to: {{ corporationsLink.OwnedCorporate.Id }}, label: '{{corporationsLink.OwningPercentage }}%'  });
  {% endfor %}

  {% for corporationsLink in corporate.shareholdings %}
    nodesData.push( {id: {{ corporationsLink.OwnedCorporate.Id }}, label: '{{ corporationsLink.OwnedCorporate.Name }}' } );
    links.push({from: {{ corporationsLink.OwningCorporate.Id }}, to: {{ corporationsLink.OwnedCorporate.Id }}, label: '{{corporationsLink.OwningPercentage }}%' });
  {% endfor %}

</script>
     {% endblock %}
{% endblock %}
